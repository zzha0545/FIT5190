# 体重预测线性模型

这个项目实现了一个基于线性回归的体重预测模型，使用身高(cm)和性别作为特征来预测学生的体重(kg)。

## 项目说明

这个项目是为了解决以下问题：
- 使用身高和性别特征，建立线性模型预测体重
- 线性模型格式：Y = WX + ε
  - Y: 学生体重
  - X: 特征（身高和性别）
  - W: 模型系数
  - ε: 截距/偏差项

## 功能特点

- 从CSV文件读取学生数据（身高、体重、性别）
- 数据预处理（处理缺失值、特征编码）
- 训练线性回归模型
- 模型评估（MSE、R²）
- 数据可视化（散点图、预测值与实际值对比、残差分析）
- 交互式预测功能（输入身高和性别，预测体重）
- 批量测试功能（从CSV文件读取测试数据，计算MAE）

## 使用方法

1. 准备数据：创建一个CSV文件，包含以下列：
   - `height`: 身高(cm)
   - `weight`: 体重(kg)
   - `gender`: 性别(M/F)

2. 安装依赖：
   ```bash
   pip install pandas numpy matplotlib scikit-learn
   ```

3. 运行程序：
   ```bash
   python weight_prediction.py
   ```

4. 程序执行流程：
   - 输入训练数据文件路径（默认为student_data.csv）
   - 程序加载数据并显示基本信息
   - 进行数据预处理
   - 训练线性回归模型并显示模型评估结果
   - 选择操作模式：
     - 单个预测：输入身高和性别，得到预测体重
     - 批量测试：从CSV文件读取测试数据，计算MAE并可选保存结果
     - 退出程序

## 批量测试

批量测试功能可以从CSV文件读取测试数据，并计算预测结果的平均绝对误差(MAE)：

1. 准备测试数据CSV文件，格式与训练数据相同
2. 选择"批量测试"选项
3. 输入测试数据文件路径
4. 查看测试结果，包括：
   - 平均绝对误差(MAE)
   - 最大/最小绝对误差
   - 误差标准差
   - 按性别分组的MAE
5. 可选择将预测结果保存到新的CSV文件

## 示例数据

项目包含以下示例数据文件：
- `student_data.csv`: 训练数据文件
- `test_data.csv`: 测试数据文件
- `generate_data.py`: 生成随机学生数据的脚本（可选） 